\ProvidesPackage{addressbook2}
\usepackage{times}
\usepackage{babel}
\usepackage{graphicx}
\usepackage{layout}
\usepackage{parskip}
\usepackage{ulem}
\usepackage{ragged2e}
\usepackage{type1cm}
\usepackage{fp}
\usepackage{makeidx}
\usepackage{multicol}
%\usepackage{hyperref}
\usepackage[
	paperwidth=105mm,
	paperheight=148mm,
	top=10mm,
	bottom=10mm,
	inner=10mm,
	outer=10mm,
	includefoot, footskip=12pt,footnotesep=1pt,twoside]
{geometry}
\newcommand{\Init}[0]{
	%\setlength{\parskip}{0mm plus1ex minus0mm}
	\setlength{\parskip}{0cm}
	\setcounter{LTchunksize}{1000}
	\setlength\fboxsep{0pt}
	\FPmessagesfalse
	%\FPdebugtrue
	\setlength{\cftbeforechapskip}{2ex}
	\setlength{\cftbeforesecskip}{2.5ex}
}
\newcommand*{\l@province}{\@dottedtocline{0}{0em}{0em}}
\newcommand*{\l@district}{\@dottedtocline{0}{1em}{0em}}
\newcommand*{\l@meeting}{\@dottedtocline{0}{2em}{0em}}

\newcommand{\MakeTOC}[0]{
%\xxRescaleFonts{80}
	\setlength{\columnseprule}{1pt}
	\setlength{\columnsep}{10pt}
	\begin{multicols}{2}
		\tableofcontents
	\end{multicols}
%\clearpage
%\xxRescaleFonts{125}
}
\newcommand{\PrintIndex}[0]{
\printindex
}
\newcount\TempCnt
\newcount\FontScaleCnt
\newcount\ProvFontCnt
\newcount\DistFontCnt
\newcount\MedSmallFontCnt
\newcount\NormalFontCnt
\newcount\SmallFontCnt
\newcount\VSmallFontCnt
\newcommand{\SelectFontSize}[1]{\fontsize {#1}{#1} \selectfont}

%\newcommand{\SelectFontSizeScaled}[2]{\FPmul\TempCnt{#2}{#1}
%\SelectFontSize{\TempCnt}}
\providecommand{\ProvHFont}[0]{\SelectFontSize{\ProvFontCnt}} \providecommand{\DistrictHFont}[0]{\SelectFontSize{\DistFontCnt}}
\providecommand{\MtgHFont}[0]{\SelectFontSize{\NormalFontCnt}}
\providecommand{\ProvHIdxFont}[0]{\SelectFontSize{\DistFontCnt}}
\providecommand{\DistrictHIdxFont}[0]{\SelectFontSize{\NormalFontCnt}}
\providecommand{\MtgHIdxFont}[0]{\SelectFontSize{\MedSmallFontCnt}}
\providecommand{\SurnameFont}[0]{\SelectFontSize{\SmallFontCnt}}
\providecommand{\PhoneFont}[0]{\SelectFontSize{\SmallFontCnt}}
\providecommand{\MtgPropsFont}[0]{\SelectFontSize{\VSmallFontCnt}}
\providecommand{\AddressFont}[0]{\SelectFontSize{\VSmallFontCnt}}

\newcommand{\xxClipCounters}[0]{
\FPclip\ProvFontCnt{\ProvFontCnt{}}
\FPclip\DistFontCnt{\DistFontCnt{}}
\FPclip\MedSmallFontCnt{\MedSmallFontCnt{}}
\FPclip\NormalFontCnt{\NormalFontCnt{}}
\FPclip\SmallFontCnt{\SmallFontCnt{}}
\FPclip\VSmallFontCnt{\VSmallFontCnt{}}
}
\newcommand{\xxFontScaling}[1]{
\FPset\FontScaleCnt{#1}% \FPprint\FontScaleCnt
\xxCustomSize
}
\newcommand{\xxCustomSize}[0]{
\FPmul\ProvFontCnt{0.16}{\FontScaleCnt{}} %\FPdiv\ProvFontCnt{\ProvFontCnt{}}{100}
\FPmul\DistFontCnt{0.14}{\FontScaleCnt{}} %\FPdiv\DistFontCnt{\DistFontCnt{}}{100}
\FPmul\NormalFontCnt{0.13}{\FontScaleCnt{}} %\FPdiv\NormalFontCnt{\NormalFontCnt{}}{100}
\FPmul\MedSmallFontCnt{0.12}{\FontScaleCnt{}} %\FPdiv\NormalFontCnt{\NormalFontCnt{}}{100}
\FPmul\SmallFontCnt{0.10}{\FontScaleCnt{}} %\FPdiv\SmallFontCnt{\SmallFontCnt{}}{100}
\FPmul\VSmallFontCnt{0.09}{\FontScaleCnt{}} %\FPdiv\VSmallFontCnt{\VSmallFontCnt{}}{100}
\xxClipCounters
}

\newcommand{\xxRescaleFonts}[1]{
%\FPmul\ProvFontCnt{16}{#1} 
%\FPdiv\ProvFontCnt{\ProvFontCnt{}}{100}
\xxClipCounters
}

\newcommand{\xxColWidths}[2]{
\newdimen\SurnameDim
\SurnameDim=#1
\newdimen\PhoneDim
\PhoneDim=#2
\newdimen\AddrDim
\AddrDim=\textwidth
\advance \AddrDim by -\SurnameDim
\advance \AddrDim by -\PhoneDim
\newdimen\AddrPhoneDim 
\AddrPhoneDim \AddrDim
\advance\AddrPhoneDim by \PhoneDim
\newdimen\SurAddrDim 
\SurAddrDim \AddrDim
\advance\SurAddrDim \SurnameDim
\newdimen\SurAddrPhoneDim 
\SurAddrPhoneDim\SurAddrDim
\advance\SurAddrPhoneDim by \PhoneDim
}
\providecommand{\CSSurnameWidth}[0]{\SurnameDim}
\providecommand{\CSAddressWidth}[0]{\AddrDim}
\providecommand{\CSPhoneWidth}[0]{\PhoneDim}
\providecommand{\CSAddressPhoneWidth}[0]{\AddrPhoneDim}
\providecommand{\CSSurAddressWidth}[0]{\SurAddrDim}
\providecommand{\CSSurAddressPhoneWidth}[0]{\SurAddrPhoneDim}


\newcommand{\CSXSmall}[0]{
\xxColWidths{18mm}{21mm}
\xxFontScaling{70}\relax
}
\newcommand{\CSSmall}[0]{
\xxColWidths{18mm}{22mm}
\xxFontScaling{80}\relax
}
\newcommand{\CSNormal}[0]{
\xxColWidths{18mm}{25mm}
\xxFontScaling{90}\relax
}
\newcommand{\CSLarge}[0]{
\xxColWidths{18mm}{26mm}
\xxFontScaling{100}\relax
}
\newcommand{\CSXLarge}[0]{
\xxColWidths{18mm}{27mm}
\xxFontScaling{110}\relax
}

\def\ulineB{\bgroup \ULdepth=0.1ex \ULset}

\newcommand{\ProvH}[1]{\ProvHFont \scshape \centering{ #1} \par \nobreak\vskip -1ex \index{#1@{\ProvHIdxFont\scshape#1}} \addcontentsline{toc}{province}{#1}\nobreak}

\newcommand{\DistrictH}[1]{\normalfont \DistrictHFont \centering{#1} \par \nobreak\vskip -1ex\index{#1@{\DistrictHIdxFont\textit{#1}}}\addcontentsline{toc}{district}{#1}\nobreak}
\newcommand{\MeetingH}[1]{\normalfont \MtgHFont \vskip -0.7ex
	\raggedright{\ulineB{#1}}\par \nobreak \index{#1@{\normalfont \MtgHIdxFont{#1}}}\addcontentsline{toc}{meeting}{#1}\nobreak}%\xxVFill}

\newcommand{\BeginHomes}[0]{} 
\newcommand{\EndHomes}[0]{}

\newcommand{\Surname}[1]{\textbf{\SurnameFont#1}\strut}
\newcommand{\MtgProps}[1]{\def\testa{#1} \def\testb{}
	\ifx\testb\testa {} \else \MtgPropsFont \textit{#1} \fi } 
\newcommand{\Address}[1]{\raggedright{\AddressFont  #1 }}
\newcommand{\Phone}[1]{\raggedleft{\PhoneFont #1}}

\newcommand{\SurnameWidth}[0]{\CSSurnameWidth}
\newcommand{\AddressWidth}[0]{\CSAddressWidth}
\newcommand{\PhoneWidth}[0]{\CSPhoneWidth}
\newcommand{\TextWidth}[0]{88mm}
\newcommand{\RuleWidth}[0]{87mm}

\newcommand{\xxVFill}[0]{}%\vfill}
%\newcommand{\xxRule}[0]{}

\newcommand{\xxHomeZimR}[4]{
%\baselineskip=-1000pt
\lineskip=0.3ex
\lineskiplimit\maxdimen

\setlength\fboxsep{0pt}
\setbox0=\hbox{\raggedright{\Surname{#1}}} 
\setbox1=\hbox{\hskip -0.45em\raggedright{\MtgProps{#2}}}
\setbox2=\vtop{
	\hsize=\SurnameWidth \box0 \def\testa{#2} \def\testb{}
	\ifx\testb\testa {} \else  \vskip -0.5ex \box1 \fi }
\dimen0=\wd2
\wd2=0pt
\advance \dimen0 by 0.2em

\dimen1=\AddressWidth
\dimen2=\AddressWidth
\advance\dimen1 by -1\dimen0
\advance\dimen2 by -1em
\def\testa{#2} \def\testb{}
\ifx\testb\testa 
	\setbox3=\vtop{\hsize=\AddressWidth
	%\hangindent=\dimen0 \hangafter=-1
	\parshape 2 \dimen0 \dimen1 1em \dimen2
	\Address {#3}}
\else
	\setbox3=\hbox{\raise 0.15ex\vtop{ 
	\hsize=\AddressWidth 
	\parshape 3 \dimen0 \dimen1 \dimen0 \dimen1 
	1em \dimen2	\Address {#3}}}
\fi

\setbox4=\vtop{\hsize=\PhoneWidth \Phone {#4}}
\setbox5= \vtop{\hskip-0.25em \box2
		\box3 \hskip0.24em
		\box4 \vskip 1pt
		\hrule height.5pt depth.0pt
		}
{\box5}
}

\newcommand{\HomeZimR}[4]{
\def\testa{#4} \def\testb{}
\ifx\testb\testa 
	\renewcommand{\AddressWidth}[0]{\CSSurAddressPhoneWidth}
	\renewcommand{\PhoneWidth}[0]{0pt}
\else
	\renewcommand{\AddressWidth}[0]{\CSSurAddressWidth}
	\renewcommand{\PhoneWidth}[0]{\CSPhoneWidth}
\fi
\xxHomeZimR{#1}{#2}{#3}{#4}
}

