\ProvidesPackage{addressbook2}
\usepackage{times}
\usepackage{babel}
%\usepackage{multirow}
%\usepackage{longtable}
\usepackage{graphicx}
\usepackage{layout}
\usepackage{parskip}
\usepackage{ulem}
\usepackage{ragged2e}
%\usepackage{tabularx}
\usepackage{type1cm}
\usepackage{fp}
\usepackage[
	paperwidth=105mm,
	paperheight=148mm,
	top=10mm,
	bottom=10mm,
	inner=10mm,
	outer=10mm,
	includefoot, footskip=12pt,footnotesep=1pt,twoside]
{geometry}
\newcommand{\Init}[0]{
	%\setlength{\parskip}{0mm plus1ex minus0mm}
	\setlength{\parskip}{0cm}
	\setcounter{LTchunksize}{1000}
	\setlength\fboxsep{0pt}
	\FPmessagesfalse
}

\newcommand{\SelectFontSize}[1]{\fontsize {#1}{#1} \selectfont}

\newcommand{\xxCustomSize}[1]{
\newcount\CalcFont
\newcount\ProvFontCnt
\newcount\DistFontCnt
\newcount\NormalFontCnt
\newcount\SmallFontCnt
\newcount\VSmallFontCnt
\FPmul\ProvFontCnt{15}{#1} \FPdiv\ProvFontCnt{\ProvFontCnt{}}{100}
\FPmul\DistFontCnt{13}{#1} \FPdiv\DistFontCnt{\DistFontCnt{}}{100}
\FPmul\NormalFontCnt{12}{#1} \FPdiv\NormalFontCnt{\NormalFontCnt{}}{100}
\FPmul\SmallFontCnt{10}{#1} \FPdiv\SmallFontCnt{\SmallFontCnt{}}{100}
\FPmul\VSmallFontCnt{8}{#1} \FPdiv\VSmallFontCnt{\VSmallFontCnt{}}{100}
\providecommand{\ProvHFont}[0]{\SelectFontSize{\ProvFontCnt}} \providecommand{\DistrictHFont}[0]{\SelectFontSize{\DistFontCnt}}
\providecommand{\MtgHFont}[0]{\SelectFontSize{\NormalFontCnt}}
\providecommand{\SurnameFont}[0]{\SelectFontSize{\SmallFontCnt}}
\providecommand{\PhoneFont}[0]{\SelectFontSize{\SmallFontCnt}}
\providecommand{\MtgPropsFont}[0]{\SelectFontSize{\VSmallFontCnt}}
\providecommand{\AddressFont}[0]{\SelectFontSize{\VSmallFontCnt}}
}
\newcommand{\xxColWidths}[2]{
\newdimen\SurnameDim
\SurnameDim=#1
\newdimen\PhoneDim
\PhoneDim=#2
\newdimen\AddrDim
\AddrDim=\textwidth
\advance \AddrDim by -\SurnameDim
\advance \AddrDim by -\PhoneDim
\newdimen\AddrPhoneDim 
\AddrPhoneDim \AddrDim
\advance\AddrPhoneDim by \PhoneDim
\newdimen\SurAddrDim 
\SurAddrDim \AddrDim
\advance\SurAddrDim \SurnameDim
\newdimen\SurAddrPhoneDim 
\SurAddrPhoneDim\SurAddrDim
\advance\SurAddrPhoneDim by \PhoneDim
\providecommand{\CSSurnameWidth}[0]{\SurnameDim}
\providecommand{\CSAddressWidth}[0]{\AddrDim}
\providecommand{\CSPhoneWidth}[0]{\PhoneDim}
\providecommand{\CSAddressPhoneWidth}[0]{\AddrPhoneDim}
\providecommand{\CSSurAddressWidth}[0]{\SurAddrDim}
\providecommand{\CSSurAddressPhoneWidth}[0]{\SurAddrPhoneDim}
}

\newcommand{\CSXSmall}[0]{
\xxColWidths{18mm}{21mm}
\xxCustomSize{70}
}
\newcommand{\CSSmall}[0]{
\xxColWidths{18mm}{22mm}
\xxCustomSize{80}
}
\newcommand{\CSNormal}[0]{
\xxColWidths{18mm}{25mm}
\xxCustomSize{90}
}
\newcommand{\CSLarge}[0]{
\xxColWidths{18mm}{26mm}
\xxCustomSize{100}
}
\newcommand{\CSXLarge}[0]{
\xxColWidths{18mm}{27mm}
\xxCustomSize{110}
}

\def\ulineB{\bgroup \ULdepth=0.1ex \ULset}
\newcommand{\ProvH}[1]{\ProvHFont \scshape \centering{ #1} \\*[-0ex]  \xxVFill}
\newcommand{\DistrictH}[1]{\normalfont \DistrictHFont \centering{#1} \\*[-1ex] \nopagebreak[4] }%\xxVFill}
\newcommand{\MeetingH}[1]{\normalfont  \MtgHFont \raggedright{\ulineB{#1}}\\*[-1ex]\nopagebreak[4] }%\xxVFill}

\newcommand{\BeginDetails}[0]{
} 

\newcommand{\EndDetails}[0]{
}

\newcommand{\Surname}[1]{\textbf{\SurnameFont#1}}
\newcommand{\MtgProps}[1]{\def\testa{#1} \def\testb{}
\ifx\testb\testa {} \else \MtgPropsFont \textit{#1} \fi } 


\newcommand{\Address}[1]{\raggedright{\AddressFont  #1 }}
%\newcommand{\Address}[1]{\AddressFont  #1}

\newcommand{\Phone}[1]{\raggedleft{\PhoneFont #1}}

\newcommand{\SurnameWidth}[0]{\CSSurnameWidth}
\newcommand{\AddressWidth}[0]{\CSAddressWidth}
\newcommand{\PhoneWidth}[0]{\CSPhoneWidth}
\newcommand{\TextWidth}[0]{88mm}
\newcommand{\RuleWidth}[0]{87mm}

\newcommand{\xxVFill}[0]{}%\vfill}
%\newcommand{\xxRule}[0]{\vskip -0.9\baselineskip \rule{\RuleWidth}{1pt} \vskip -0.9\baselineskip}%\vfill}

%\providecommand{\xxRule}[0]{\hbox{\hrule height 5pt depth 5pt}}
%\newsavebox{\fmbox}
%\newenvironment{fmpage}[1]
%{\begin{lrbox}{\fmbox}\begin{minipage}{#1}}
%{\end{minipage}\end{lrbox}\fbox{\usebox{\fmbox}}}

\newcommand{\xxDetailZimR}[4]{
	\setlength\fboxsep{0pt}

\setbox0=\hbox{\Surname{#1}  \hfill} 
\setbox1=\hbox{\MtgProps{#2}}
\setbox2=\vtop{
	\hsize=\SurnameWidth \copy0 \def\testa{#2} \def\testb{}
	\ifx\testb\testa {} \else \vskip -0.6ex \box1 \fi }

\dimen0=\wd2
\wd2=0pt
\advance \dimen0 by -0.25em
\dimen1=\AddressWidth
\dimen2=\AddressWidth
\advance\dimen1 by -1\dimen0
\advance\dimen2 by -1em
\def\testa{#2} \def\testb{}
\ifx\testb\testa 
	\setbox3=\vtop{ \hsize=\AddressWidth
	%\hangindent=\dimen0 \hangafter=-1
	\parshape 2 \dimen0 \dimen1 1em \dimen2
	\Address {#3}}
	
\else
	\setbox3=\hbox{\raise 0.3ex\vtop{ 
	\hsize=\AddressWidth 
	\parshape 3 \dimen0 \dimen1 \dimen0 \dimen1 1em \dimen2	\Address {#3}}}
\fi

%\dimen0=\dp3
%\dimen1=\ht2
%\advance\dimen1 by \baselineskip
%\advance \dimen0 by -\baselineskip
%\ht3=\dimen1
%\dp3=\dimen0

\setbox4=\vtop{\hsize=\PhoneWidth \Phone {#4}}

\setbox5= \vtop{\hskip-0.25em \hbox{\hbox{\box2} %\hskip-0.25em
		 \hbox{\box3} \hskip-0.3em
		\hbox{{\box4}} }\vskip 0.5pt\hrule height.5pt depth.0pt}
{\box5}
%\xxRule  
%\vskip -0.5\baselineskip
}

\newcommand{\DetailZimR}[4]{
\def\testa{#4} \def\testb{}
\ifx\testb\testa 
	\renewcommand{\AddressWidth}[0]{\CSSurAddressPhoneWidth}
	\renewcommand{\PhoneWidth}[0]{0pt}
\else
	\renewcommand{\AddressWidth}[0]{\CSSurAddressWidth}
	\renewcommand{\PhoneWidth}[0]{\CSPhoneWidth}
\fi
\xxDetailZimR{#1}{#2}{#3}{#4}
}

\newcommand{\DetailZimRNoPhone}[3]{
	\DetailZimR{#1}{#2}{#3}{}
}
